
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  
    <title>Android 9.0变化 | hjhjw1991&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="hjhjw1991">
    

    
    <meta name="description" content="Android 9.0(Android P), Google对Android的控制加强了. 而且, 影响所有应用.">
<meta name="keywords" content="android">
<meta property="og:type" content="article">
<meta property="og:title" content="Android 9.0变化">
<meta property="og:url" content="https://hjhjw1991.github.io/android/2018/06/13/Android-9.0变化/index.html">
<meta property="og:site_name" content="hjhjw1991&#39;s blog">
<meta property="og:description" content="Android 9.0(Android P), Google对Android的控制加强了. 而且, 影响所有应用.">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-02-20T16:36:35.396Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android 9.0变化">
<meta name="twitter:description" content="Android 9.0(Android P), Google对Android的控制加强了. 而且, 影响所有应用.">

    
    <link rel="alternative" href="/atom.xml" title="hjhjw1991&#39;s blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/author.png">
    <link rel="apple-touch-icon-precomposed" href="/img/author.png">
    
    <link rel="stylesheet" href="/css/style.css">
</head>
</html>
  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="hjhjw1991&#39;s blog" title="hjhjw1991&#39;s blog"></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="hjhjw1991&#39;s blog">hjhjw1991&#39;s blog</a></h1>
				<h2 class="blog-motto">Coder, Learn</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
						<form class="search" action="http://zhannei.baidu.com/cse/search" target="_blank">
							<label>Search</label>
						<input name="s" type="hidden" value="8741923514077570040"><input type="text" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</ul></nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/android/2018/06/13/Android-9.0变化/" title="Android 9.0变化" itemprop="url">Android 9.0变化</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="hjhjw1991" target="_blank" itemprop="author">hjhjw1991</a>
		
  </p><p class="article-time">
    <time datetime="2018-06-12T16:00:00.000Z" itemprop="datePublished"> 发表于 2018-06-13</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#在Android-P上运行的所有应用"><span class="toc-number">1.</span> <span class="toc-text">在Android P上运行的所有应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#后台应用中的输入和数据隐私"><span class="toc-number">1.1.</span> <span class="toc-text">后台应用中的输入和数据隐私</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设备安全性变更"><span class="toc-number">1.2.</span> <span class="toc-text">设备安全性变更</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用兼容性变更"><span class="toc-number">1.3.</span> <span class="toc-text">应用兼容性变更</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ICU库更新"><span class="toc-number">1.4.</span> <span class="toc-text">ICU库更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不再支持Android安全加密文件-ASEC"><span class="toc-number">1.5.</span> <span class="toc-text">不再支持Android安全加密文件(ASEC)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试库"><span class="toc-number">1.6.</span> <span class="toc-text">测试库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-UTF解码器"><span class="toc-number">1.7.</span> <span class="toc-text">Java UTF解码器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用证书的主机名验证"><span class="toc-number">1.8.</span> <span class="toc-text">使用证书的主机名验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络地址查询可能会导致网络违规"><span class="toc-number">1.9.</span> <span class="toc-text">网络地址查询可能会导致网络违规</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#套接字标记"><span class="toc-number">1.10.</span> <span class="toc-text">套接字标记</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用无法再访问-xt-qtaguid-文件夹中的文件"><span class="toc-number">1.11.</span> <span class="toc-text">应用无法再访问  xt_qtaguid 文件夹中的文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#强制执行-FLAG-ACTIVITY-NEW-TASK-要求"><span class="toc-number">1.12.</span> <span class="toc-text">强制执行 FLAG_ACTIVITY_NEW_TASK 要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#屏幕旋转变更"><span class="toc-number">1.13.</span> <span class="toc-text">屏幕旋转变更</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#针对Android-P的应用"><span class="toc-number">2.</span> <span class="toc-text">针对Android P的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#前台服务"><span class="toc-number">2.1.</span> <span class="toc-text">前台服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设备序列号访问限制"><span class="toc-number">2.2.</span> <span class="toc-text">设备序列号访问限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#框架安全性变更"><span class="toc-number">2.3.</span> <span class="toc-text">框架安全性变更</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#视图焦点"><span class="toc-number">2.4.</span> <span class="toc-text">视图焦点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文档滚动标签"><span class="toc-number">2.5.</span> <span class="toc-text">文档滚动标签</span></a></li></ol></li></ol>
		
		</div>
		
		<p>Android 9.0(Android P), Google对Android的控制加强了. 而且, 影响所有应用.  </p>
<p>官网见<a href="https://developer.android.com/preview/behavior-changes" target="_blank" rel="noopener">这里</a>  </p>
<p>今后在Android P系统上运行的所有应用, 可能都会受到影响, 不管这个应用以什么API为TargetAPI.  </p>
<p>我按照官网的区分方式来搬运内容, 分为<a href="#targetAll">针对所有API级别的应用</a> 和 <a href="#targetP">针对Android P的应用</a></p>
<p><div id="targetAll"></div></p>
<h2 id="在Android-P上运行的所有应用"><a href="#在Android-P上运行的所有应用" class="headerlink" title="在Android P上运行的所有应用"></a>在Android P上运行的所有应用</h2><h3 id="后台应用中的输入和数据隐私"><a href="#后台应用中的输入和数据隐私" class="headerlink" title="后台应用中的输入和数据隐私"></a>后台应用中的输入和数据隐私</h3><p>限制了后台应用访问用户输入和传感器数据的能力. 如果应用在后台运行, 系统限制:  </p>
<ul>
<li>应用不能放问摄像头或麦克风. – 这意味着偷偷录音录像恐怕不行, 但是我们天才的开发人员可能会搞个1像素的前台应用来规避.  </li>
<li>使用连续报告模式的传感器(例如加速度计和陀螺仪)不会接收事件. – 大概无法在后台持续获取运动速度.  </li>
<li>使用发送变化时或一次性报告模式的传感器不会接收事件. – 大概无法在后台获取传感器变化.  </li>
</ul>
<p>如果要检测传感器事件, 需要使用前台服务.<br>但是如果你使用的是SensorManager的实例来调用flush()方法, 则不受影响.<br>这个变更可能会影响后台检测传感器数据的应用, 例如地图等.  </p>
<h3 id="设备安全性变更"><a href="#设备安全性变更" class="headerlink" title="设备安全性变更"></a>设备安全性变更</h3><p>提供密钥轮转和系统调用保护, 具体变更见<a href="https://developer.android.com/preview/features/security-behav#all-apps" target="_blank" rel="noopener">安全行为变更</a>.<br>加密算法实现发生变更, 部分加密算法参数(AES, DESEDE, OAEP, EC)的Bouncy Castle版本在Android P中已经弃用, 如果App的目标是Android 8.1 (API 27)及以下, 使用上述已弃用的算法实现, 会收到警告信息, 如果目标是28及以上会引发NoSuchAlgorithmException异常.  </p>
<h3 id="应用兼容性变更"><a href="#应用兼容性变更" class="headerlink" title="应用兼容性变更"></a>应用兼容性变更</h3><p>对某些非SDK函数和字段的使用进行了限制. <strong>这个就是盛传的禁用非公开API的限制</strong>. 无论是直接访问还是通过反射或JNI方式访问, 这些限制都适用. 在Developer Preview 1版本中, 访问这些API或字段, 平台会通过toast和日志方式提醒你注意. 官方的<a href="https://developer.android.com/preview/restrictions-non-sdk-interfaces" target="_blank" rel="noopener">说明文档</a>详细解释了非SDK接口的定义以及警告的方式.<br>这个变更, 最有可能影响到的就是通过反射调用私有接口的一系列操作, 特别是热修复/插件化/Xposed等. 关于这点, 360的技术团队已经替我们走了一遍代码, 具体见<a href="https://mp.weixin.qq.com/s?__biz=MzUxMTcwOTM4Mg==&amp;mid=2247483664&amp;idx=1&amp;sn=4f9f733d3caedf2829be703df8e69cd8&amp;chksm=f96ed8b9ce1951aff1e598a9724b395de8b7d9ad7c1cb68ccb56cf828749eb44086aeef362d3&amp;mpshare=1&amp;scene=1&amp;srcid=0605RdcBLfPCbWY2ZjXfkick&amp;pass_ticket=35w9Ly2pos1q7FcZ5%2FXLA4TvdyYZBCurisx2fmeousnfev3rL8w2UYjrDKF8tNBk#rd" target="_blank" rel="noopener">Android P调用隐藏API限制原理</a>和<a href="https://mp.weixin.qq.com/s?__biz=MzUxMTcwOTM4Mg==&amp;mid=2247483686&amp;idx=1&amp;sn=fae8d2edc88e4e51628970e8959989b6&amp;chksm=f96ed88fce195199f0333c163b2abf5712768f3a607ef39d3a8c8d10e8139e629fe3f79c3e5b&amp;mpshare=1&amp;scene=1&amp;srcid=0605FYMIH8cKFHxsxvlfPosn&amp;pass_ticket=35w9Ly2pos1q7FcZ5%2FXLA4TvdyYZBCurisx2fmeousnfev3rL8w2UYjrDKF8tNBk#rd" target="_blank" rel="noopener">突破限制的方法</a>.  </p>
<h3 id="ICU库更新"><a href="#ICU库更新" class="headerlink" title="ICU库更新"></a>ICU库更新</h3><p>ICU是<code>International Components for Unicode</code>, 它本是一个单独的项目<a href="https://developer.android.com/guide/topics/resources/internationalization" target="_blank" rel="noopener">Android官网说明</a>, Android引用了它来完成国际化支持, 例如拾取, emoji, 文本等. 它的公开API在<code>android.icu</code>包下.<br>现在它的版本更新到了60.<br>由于它被平台内部使用, 所以即便我们没有直接用到icu包内的API, 也要注意我们引用的其他API可能对它有间接引用, 从而受到影响.<br>特别是: 用到<code>java.text.SimpleDateFormat</code>和<code>java.text.DateFormatSymbols.getZoneStrings()</code>中关于时区的表示形式已经发生变更.  </p>
<h3 id="不再支持Android安全加密文件-ASEC"><a href="#不再支持Android安全加密文件-ASEC" class="headerlink" title="不再支持Android安全加密文件(ASEC)"></a>不再支持Android安全加密文件(ASEC)</h3><p>Android安全加密文件(ASEC)在API 8引入, 用于支持原始的SD卡加载应用功能. Android 6.0(API 23)替换并弃用了ASEC, 引入了”可采用的SD卡”功能.<br>Android 8.0(API 26)禁止在ASEC中安装新应用, 本预览版则完全移除了ASEC功能.<br>这个功能既然是为SD卡加载应用而生的, 那么这个功能的移除也是可以理解: 越来越多的手机已经不支持外置SD卡了.<br>用到ASEC这个技术的应用(例如虚拟桌面等app), 特别是自定义rom的厂商, 需要注意.  </p>
<h3 id="测试库"><a href="#测试库" class="headerlink" title="测试库"></a>测试库</h3><p>测试套件<code>TestSuiteBuilder</code>被弃用.<br>Android P框架中移除了内置的测试类, 以让开发者能更灵活地应用其他测试框架和测试库. 原测试库作为可选依赖项使用. 尽管平时可能用的比较少, 仍然建议大家看一下<a href="https://developer.android.com/training/testing/" target="_blank" rel="noopener">Android上测试应用</a>.    </p>
<h3 id="Java-UTF解码器"><a href="#Java-UTF解码器" class="headerlink" title="Java UTF解码器"></a>Java UTF解码器</h3><p>Android P中的UTF-8解码器更加严格, 其遵循Unicode标准:  </p>
<ul>
<li>非最短形式的 UTF-8（例如 <code>&lt;C0, AF&gt;</code>）现在被视为格式不正确.  </li>
<li>替代形式的 UTF-8（例如 <code>U+D800..U+DFFF</code>）现在被视为格式不正确.  </li>
<li>最大的子部分被单个 U+FFFD 取代. 例如, 在字节序列<code>41 C0 AF 41 F4 80 80 41</code>中, 最大子部分为<code>C0</code>、<code>AF</code>和<code>F4 80 80</code>.其中“F4 80 80”可以是<code>F4 80 80 80</code>的初始子序列, 但“C0”不能是任何形式正确的代码单位序列的初始子序列. 因此, 输出应为<code>A\ufffd\ufffdA\ufffdA</code>.  </li>
<li>要在 Android P 中解码修改后的 UTF-8/CESU-8 序列, 请使用 <code>DataInputStream.readUTF()</code> 函数或 <code>NewStringUTF()</code> JNI 函数.  </li>
</ul>
<!-- 以下均关于网络 -->
<h3 id="使用证书的主机名验证"><a href="#使用证书的主机名验证" class="headerlink" title="使用证书的主机名验证"></a>使用证书的主机名验证</h3><p>使用<code>subjectAltName(SAN)</code>扩展程序中的可用名称进行对照证书匹配域名. 不再回退到<code>commonName(CN)</code>.</p>
<h3 id="网络地址查询可能会导致网络违规"><a href="#网络地址查询可能会导致网络违规" class="headerlink" title="网络地址查询可能会导致网络违规"></a>网络地址查询可能会导致网络违规</h3><p>要求名称解析的网络地址查询可能会产生网络I/O, 当这种情况发生在主线程就可能导致停顿或卡顿.<br><code>StrictMode</code>现在可以检测以上这种情况的网络违规.<br>解析数字IP地址不被视为阻塞性操作.  </p>
<h3 id="套接字标记"><a href="#套接字标记" class="headerlink" title="套接字标记"></a>套接字标记</h3><p>在 Android P 以前的平台版本上, 如果使用 <code>setThreadStatsTag()</code> 函数标记某个套接字, 则当使用带 <code>ParcelFileDescriptor</code> 容器的<a href="https://source.android.com/devices/architecture/hidl/binder-ipc#ipc" target="_blank" rel="noopener"><code>binder IPC</code></a> 将其发送给其他进程时, 套接字会被取消标记.(我感觉是个bug)</p>
<p>从 Android P 开始, 利用 <code>binder IPC</code> 将套接字发送至其他进程时, 其标记将得到保留. 此变更可能影响网络流量统计, 例如, 使用<code>queryDetailsForUidTag()</code> 函数时.<br>您可以通过先调用 <code>untagSocket()</code> 然后再将套接字发送至其他进程, 以此来保持行为跟以前一致.</p>
<p>在调用 <code>shutdownInput()</code> 函数后调用 <code>available()</code> 函数会返回 <code>0</code>.  </p>
<p>从 Android P 开始, 当 VPN 调用 <code>setUnderlyingNetworks()</code> 函数时, Android 系统将会合并任何底层网络的传输和能力并返回 VPN 网络的有效网络能力作为结果.  </p>
<p>自 Android P 开始, 已经检查 <code>NET_CAPABILITY_NOT_METERED</code> 的应用开发者将收到关于 VPN 网络能力和底层网络的信息.  </p>
<h3 id="应用无法再访问-xt-qtaguid-文件夹中的文件"><a href="#应用无法再访问-xt-qtaguid-文件夹中的文件" class="headerlink" title="应用无法再访问  xt_qtaguid 文件夹中的文件"></a>应用无法再访问  xt_qtaguid 文件夹中的文件</h3><p>不允许应用直接读取 <code>/proc/net/xt_qtaguid</code> 文件夹中的文件. 因为有些设备在发布时运行ANdroid P, 但没有提供这些文件.  </p>
<h3 id="强制执行-FLAG-ACTIVITY-NEW-TASK-要求"><a href="#强制执行-FLAG-ACTIVITY-NEW-TASK-要求" class="headerlink" title="强制执行 FLAG_ACTIVITY_NEW_TASK 要求"></a>强制执行 FLAG_ACTIVITY_NEW_TASK 要求</h3><p>在Android P中, 除非设置了<code>FLAG_ACTIVITY_NEW_TASK</code>标志, 否则不能从非Activity的环境中启动Activity. 启动失败时会输出日志.<br>在Android N之前, 标志一直是被强制执行的, Android N中的一个错误会临时阻止实施标志要求. (我感觉这是一个系统bug).  </p>
<h3 id="屏幕旋转变更"><a href="#屏幕旋转变更" class="headerlink" title="屏幕旋转变更"></a>屏幕旋转变更</h3><p>Android P对<strong>纵向旋转模式</strong>(现更名为”旋转锁定”)有重大变更. 当设备处于旋转锁定模式时, 用户可以将屏幕锁定到顶层可见Activity所支持的任何旋转(注: 就是说横屏锁定也可以了?), Activity不应假定它始终以纵向呈现.  如果顶层Activity可以支持屏幕旋转, 则应在旋转锁定模式下提供相同的选项, 根据Activity的<code>screenOrientation</code>设置, 允许存在一些例外情况.<br>请求特定屏幕方向（例如, <code>screenOrientation=landscape</code>）的 Activity 会忽略用户锁定首选项, 并且行为与 Android O 中的行为相同.<br>可在 Android 清单中, 或以编程方式通过 <code>setRequestedOrientation()</code>, 在 Activity 一级设置屏幕方向首选项.<br>旋转锁定模式通过设置WindowManager在处理Activity旋转时使用的用户旋转首选项来发挥作用. 用户旋转首选项可能在下列情况下发生变更:  </p>
<ul>
<li>当用户接收旋转建议时, 旋转首选项变为建议方向  </li>
<li>当用户切换到强制纵向应用(包括锁定屏幕, 启动器等)时, 旋转首选项变为纵向  </li>
</ul>
<p><div id="targetP"></div></p>
<h2 id="针对Android-P的应用"><a href="#针对Android-P的应用" class="headerlink" title="针对Android P的应用"></a>针对Android P的应用</h2><p>如果你的应用是针对Android P或更高版本开发, 或者<code>targetSdkVersion</code>设置为<code>Android P</code>或更高版本, 那么需要注意以下变动.  </p>
<h3 id="前台服务"><a href="#前台服务" class="headerlink" title="前台服务"></a>前台服务</h3><p>需要请求<code>FOREGROUND_SERVICE</code>权限. 这是<a href="https://developer.android.com/guide/topics/permissions/overview#normal-dangerous" target="_blank" rel="noopener">普通权限</a>, 系统会自动为请求权限的应用授予此权限.<br>如果创建前台服务但没有请求这个权限, 则系统抛出<code>SecurityException</code>异常.<br>开发者需要注意前台服务要请求这个权限.  </p>
<h3 id="设备序列号访问限制"><a href="#设备序列号访问限制" class="headerlink" title="设备序列号访问限制"></a>设备序列号访问限制</h3><p><code>Build.SERIAL</code>字段在API 26被弃用, 在Android P中, 该变量的值始终为<code>UNKNOWN</code>, 以保护用户因私.<br>如果需要访问设备的硬件序列号, 需要请求<code>READ_PHONE_STATE</code>权限, 并调用<code>getSerial()</code>方法.<br>以前有用到或依赖<code>Build.SERIAL</code>的开发者需要注意.  </p>
<h3 id="框架安全性变更"><a href="#框架安全性变更" class="headerlink" title="框架安全性变更"></a>框架安全性变更</h3><p>系统会执行更严格的网络和文件系统安全保障, 详见<a href="https://developer.android.com/preview/features/security-behav#p-apps" target="_blank" rel="noopener">以Android P为目标平台的应用的安全行为变更</a>  </p>
<h3 id="视图焦点"><a href="#视图焦点" class="headerlink" title="视图焦点"></a>视图焦点</h3><p>0面积的视图(宽度或高度为0)再不能被聚焦.<br>此外, Activity不再隐式分配触摸模式下的初始焦点, 需要显式请求.<br>Android P支持4个和8个十六进制数字的CSS颜色.<br>Chrome自版本52以来一直支持<a href="https://drafts.csswg.org/css-color/#hex-color" target="_blank" rel="noopener">CSS颜色模块级别4</a>, 但目前<code>WebView</code>停用此功能, 因为现有Android应用中, 在处理32位十六进制颜色时, 被Android ARGB干扰, 会导致渲染错误. 比如颜色<code>#80ff8080</code>, 在以Android P以下的SDK为目标的应用中, 在<code>WebView</code>中先导部分(被Android解读为Alpha)被忽略, 会渲染成不透明浅红色<code>#ff8080</code>. 现在, 以Android P或更高为目标, 则它会被解读为50%透明浅绿的<code>#80ff80</code>.  </p>
<h3 id="文档滚动标签"><a href="#文档滚动标签" class="headerlink" title="文档滚动标签"></a>文档滚动标签</h3><p>在Android P之前的版本中, 滚动位置在body元素上设置, 根元素的滚动值为0. Android P支持符合标准的行为, 在这种行为中滚动元素是<strong>根源素</strong>.<br>此外, 直接访问<code>document.body.scrollTop</code> <code>document.body.scrollLeft</code> <code>document.documentElement.scrollTop</code>或<code>document.documentElement.scrollLeft</code>会因为目标SDK的不同而具有不同的行为. 要访问视口(ViewPort)滚动值, 需要使用<code>document.scrollingElement</code>(若有).  </p>
<!-- 参考资料 -->
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/android/">android</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/android/">android</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="https://hjhjw1991.github.io/android/2018/06/13/Android-9.0变化/" data-title="Android 9.0变化 | hjhjw1991&#39;s blog" data-tsina="1304671950" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev">
 <a href="/android/2019/05/29/再论热修复-sophix热修复思想/" title="再论热修复-sophix热修复思想">
  <strong>上一篇：</strong><br>
  <span>
  再论热修复-sophix热修复思想</span>
</a>
</div>


<div class="next">
<a href="/blog/2018/06/04/Java小知识--引用类型/" title="Java小知识--引用类型">
 <strong>下一篇：</strong><br> 
 <span>Java小知识--引用类型
</span>
</a>
</div>

</nav>

	

<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#在Android-P上运行的所有应用"><span class="toc-number">1.</span> <span class="toc-text">在Android P上运行的所有应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#后台应用中的输入和数据隐私"><span class="toc-number">1.1.</span> <span class="toc-text">后台应用中的输入和数据隐私</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设备安全性变更"><span class="toc-number">1.2.</span> <span class="toc-text">设备安全性变更</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用兼容性变更"><span class="toc-number">1.3.</span> <span class="toc-text">应用兼容性变更</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ICU库更新"><span class="toc-number">1.4.</span> <span class="toc-text">ICU库更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不再支持Android安全加密文件-ASEC"><span class="toc-number">1.5.</span> <span class="toc-text">不再支持Android安全加密文件(ASEC)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试库"><span class="toc-number">1.6.</span> <span class="toc-text">测试库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-UTF解码器"><span class="toc-number">1.7.</span> <span class="toc-text">Java UTF解码器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用证书的主机名验证"><span class="toc-number">1.8.</span> <span class="toc-text">使用证书的主机名验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络地址查询可能会导致网络违规"><span class="toc-number">1.9.</span> <span class="toc-text">网络地址查询可能会导致网络违规</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#套接字标记"><span class="toc-number">1.10.</span> <span class="toc-text">套接字标记</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用无法再访问-xt-qtaguid-文件夹中的文件"><span class="toc-number">1.11.</span> <span class="toc-text">应用无法再访问  xt_qtaguid 文件夹中的文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#强制执行-FLAG-ACTIVITY-NEW-TASK-要求"><span class="toc-number">1.12.</span> <span class="toc-text">强制执行 FLAG_ACTIVITY_NEW_TASK 要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#屏幕旋转变更"><span class="toc-number">1.13.</span> <span class="toc-text">屏幕旋转变更</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#针对Android-P的应用"><span class="toc-number">2.</span> <span class="toc-text">针对Android P的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#前台服务"><span class="toc-number">2.1.</span> <span class="toc-text">前台服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设备序列号访问限制"><span class="toc-number">2.2.</span> <span class="toc-text">设备序列号访问限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#框架安全性变更"><span class="toc-number">2.3.</span> <span class="toc-text">框架安全性变更</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#视图焦点"><span class="toc-number">2.4.</span> <span class="toc-text">视图焦点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文档滚动标签"><span class="toc-number">2.5.</span> <span class="toc-text">文档滚动标签</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="hjhjw1991" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js"></script>
</div>
  </div>



  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/android/" title="android">android<sup>27</sup></a></li>
		  
		
		  
			<li><a href="/categories/blog/" title="blog">blog<sup>15</sup></a></li>
		  
		
		  
			<li><a href="/categories/leetcode/" title="leetcode">leetcode<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/opinion/" title="opinion">opinion<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/tips/" title="tips">tips<sup>4</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/android/" title="android">android<sup>28</sup></a></li>
			
		
			
				<li><a href="/tags/guide/" title="guide">guide<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/git/" title="git">git<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/interview/" title="interview">interview<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/windows/" title="windows">windows<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/jekyll/" title="jekyll">jekyll<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/vps/" title="vps">vps<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/ssh/" title="ssh">ssh<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/vpn/" title="vpn">vpn<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/python/" title="python">python<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/regex/" title="regex">regex<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/mac/" title="mac">mac<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/uwsgi/" title="uwsgi">uwsgi<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/ios/" title="ios">ios<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/linux/" title="linux">linux<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/hotfix/" title="hotfix">hotfix<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://google.com" target="_blank" title="Google">Google</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.goldenfrog.com/vyprvpn/refer-a-friend/get-a-free-month?ar=8betlkaq2h638_1" target="_blank" title="VyprVPN">VyprVPN</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="120" class="share_self" frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=1304671950&verifier=64e7ae81&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer">
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Huang Jun. <br>
			This is my blog.</p>
	</section>
	 
	<div class="social-font">
		
		<a href="http://weibo.com/1304671950" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/hjhjw1991" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		<a href="mailto:hjhjw1991@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2019 
		
		<a href="/about" target="_blank" title="hjhjw1991">hjhjw1991</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>




<script type="text/javascript">

var disqus_shortname = 'hjhjw1991';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?cd0e561542c22cc83da2e311ec57da84";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
